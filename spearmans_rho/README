#### PSingh May 2020 update ####
#### CoAdapTree project ####
#### Gene environmental association analysis (GEA) uncorrected for population structure conducted using spearman's rho correlation ###
See https://github.com/CoAdapTree/baypass_pipeline for GEA approach for taking population structure into account

This script takes SNP frequencies across populations and environmental (or phenotype) data and calculates spearman's rho
correlations. This output is then fed into a top candidate test (For more detailson this see Yeaman, Hodgins et al 2016, Convergent local adaptation to climate in distantly related conifers)

Format example for the input environmental variables (need to be standardised):

id1	id2	our_id	Latitude	Longitude	AHM	CMD	DD5	DD_0	EMT	EXT	Eref	FFP	MAP	MAT	MCMT	MSP	MWMT	NFFD	PAS	SHM	TD	bFFP	eFFP
3204	1	JP_p4	46.75	-60.35	-1.3139941388476906	-1.6340863419835896	-0.3272989157557793	-1.6533772188044684	2.406047397608793	-2.3024333427675177	-1.036417996088874	0.777080705184659	2.2008997188800947	1.0752329852967377	2.033808876635878	1.027420528095784	-0.6895817336877789	0.4751476986198461	1.266075918848708	-1.228197319265372	-2.527988921938721	0.15592387681614567	1.3497708916694497
3206	2	JP_p6	45.6835	-63.7966	-0.8349077836278714	-0.762942364450557	0.698616340788908	-1.5168443796732076	1.6994560651216502	-0.7145482787899173	0.36071410648191166	1.1263304603238316	1.479538343752544	1.3630582586075282	1.653937963329595	0.46695394887958397	0.36120947955074156	1.1790702150936911	0.8416687355164919	-0.4808471651381224	-1.7461942476037953	-0.5865707746893019	1.3497708916694497

Format example for the input snp table (top 3 lines):

CHROM	POS	REF	ALT	AF	QUAL	TYPE	FILTER	ADP	WT	HET	HOM	NC	JP_p98.GT	JP_p98.GQ	JP_p98.SDP	JP_p98.DP	JP_p98.FREQ	JP_p98.PVAL	JP_p98.AD	JP_p98.RD	JP_p31.GT	JP_p31.GQ	JP_p31.SDP	JP_p31.DP	JP_p31.FREQ	JP_p31.PVAL	JP_p31.AD	JP_p31.RD	JP_p93.GT	JP_p93.GQ	JP_p93.SDP	JP_p93.DP	JP_p93.FREQ	JP_p93.PVAL	JP_p93.AD	JP_p93.RD	JP_p24.GT	JP_p24.GQ	JP_p24.SDP	JP_p24.DP	JP_p24.FREQ	JP_p24.PVAL	JP_p24.AD	JP_p24.RD	JP_p14.GT	JP_p14.GQ	JP_p14.SDP	JP_p14.DP	JP_p14.FREQ	JP_p14.PVAL	JP_p14.AD	JP_p14.RD	JP_p70.GT	JP_p70.GQ	JP_p70.SDP	JP_p70.DP	JP_p70.FREQ	JP_p70.PVAL	JP_p70.AD	JP_p70.RD	JP_p8.GT	JP_p8.GQ	JP_p8.SDP	JP_p8.DP	JP_p8.FREQ	JP_p8.PVAL	JP_p8.AD	JP_p8.RD	JP_p95.GT	JP_p95.GQ	JP_p95.SDP	JP_p95.DP	JP_p95.FREQ	JP_p95.PVAL	JP_p95.AD	JP_p95.RD	JP_p57.GT	JP_p57.GQ	JP_p57.SDP	JP_p57.DP	JP_p57.FREQ	JP_p57.PVAL	JP_p57.AD	JP_p57.RD	JP_p96.GT	JP_p96.GQ	JP_p96.SDP	JP_p96.DP	JP_p96.FREQ	JP_p96.PVAL	JP_p96.AD	JP_p96.RD	JP_p51.GT	JP_p51.GQ	JP_p51.SDP	JP_p51.DP	JP_p51.FREQ	JP_p51.PVAL	JP_p51.AD	JP_p51.RD	JP_p73.GT	JP_p73.GQ	JP_p73.SDP	JP_p73.DP	JP_p73.FREQ	JP_p73.PVAL	JP_p73.AD	JP_p73.RD	JP_p83.GT	JP_p83.GQ	JP_p83.SDP	JP_p83.DP	JP_p83.FREQ	JP_p83.PVAL	JP_p83.AD	JP_p83.RD	JP_p26.GT	JP_p26.GQ	JP_p26.SDP	JP_p26.DP	JP_p26.FREQ	JP_p26.PVAL	JP_p26.AD	JP_p26.RD	JP_p68.GT	JP_p68.GQ	JP_p68.SDP	JP_p68.DP	JP_p68.FREQ	JP_p68.PVAL	JP_p68.AD	JP_p68.RD	JP_p6.GT	JP_p6.GQ	JP_p6.SDP	JP_p6.DP	JP_p6.FREQ	JP_p6.PVAL	JP_p6.AD	JP_p6.RD	JP_p92.GT	JP_p92.GQ	JP_p92.SDP	JP_p92.DP	JP_p92.FREQ	JP_p92.PVAL	JP_p92.AD	JP_p92.RD	JP_p72.GT	JP_p72.GQ	JP_p72.SDP	JP_p72.DP	JP_p72.FREQ	JP_p72.PVAL	JP_p72.AD	JP_p72.RD	JP_p94.GT	JP_p94.GQ	JP_p94.SDP	JP_p94.DP	JP_p94.FREQ	JP_p94.PVAL	JP_p94.AD	JP_p94.RD	JP_p62.GT	JP_p62.GQ	JP_p62.SDP	JP_p62.DP	JP_p62.FREQ	JP_p62.PVAL	JP_p62.AD	JP_p62.RD	JP_p99.GT	JP_p99.GQ	JP_p99.SDP	JP_p99.DP	JP_p99.FREQ	JP_p99.PVAL	JP_p99.AD	JP_p99.RD	JP_p39.GT	JP_p39.GQ	JP_p39.SDP	JP_p39.DP	JP_p39.FREQ	JP_p39.PVAL	JP_p39.AD	JP_p39.RD	JP_p97.GT	JP_p97.GQ	JP_p97.SDP	JP_p97.DP	JP_p97.FREQ	JP_p97.PVAL	JP_p97.AD	JP_p97.RD	JP_p90.GT	JP_p90.GQ	JP_p90.SDP	JP_p90.DP	JP_p90.FREQ	JP_p90.PVAL	JP_p90.AD	JP_p90.RD	JP_p37.GT	JP_p37.GQ	JP_p37.SDP	JP_p37.DP	JP_p37.FREQ	JP_p37.PVAL	JP_p37.AD	JP_p37.RD	JP_p84.GT	JP_p84.GQ	JP_p84.SDP	JP_p84.DP	JP_p84.FREQ	JP_p84.PVAL	JP_p84.AD	JP_p84.RD	JP_p27.GT	JP_p27.GQ	JP_p27.SDP	JP_p27.DP	JP_p27.FREQ	JP_p27.PVAL	JP_p27.AD	JP_p27.RD	JP_p82.GT	JP_p82.GQ	JP_p82.SDP	JP_p82.DP	JP_p82.FREQ	JP_p82.PVAL	JP_p82.AD	JP_p82.RD	JP_p29.GT	JP_p29.GQ	JP_p29.SDP	JP_p29.DP	JP_p29.FREQ	JP_p29.PVAL	JP_p29.AD	JP_p29.RD	JP_p20.GT	JP_p20.GQ	JP_p20.SDP	JP_p20.DP	JP_p20.FREQ	JP_p20.PVAL	JP_p20.AD	JP_p20.RD	JP_p77.GT	JP_p77.GQ	JP_p77.SDP	JP_p77.DP	JP_p77.FREQ	JP_p77.PVAL	JP_p77.AD	JP_p77.RD	JP_p4.GT	JP_p4.GQ	JP_p4.SDP	JP_p4.DP	JP_p4.FREQ	JP_p4.PVAL	JP_p4.AD	JP_p4.RD	JP_p101.GT	JP_p101.GQ	JP_p101.SDP	JP_p101.DP	JP_p101.FREQ	JP_p101.PVAL	JP_p101.AD	JP_p101.RD	JP_p60.GT	JP_p60.GQ	JP_p60.SDP	JP_p60.DP	JP_p60.FREQ	JP_p60.PVAL	JP_p60.AD	JP_p60.RD	JP_p102.GT	JP_p102.GQ	JP_p102.SDP	JP_p102.DP	JP_p102.FREQ	JP_p102.PVAL	JP_p102.AD	JP_p102.RD	JP_p100.GT	JP_p100.GQ	JP_p100.SDP	JP_p100.DP	JP_p100.FREQ	JP_p100.PVAL	JP_p100.AD	JP_p100.RD	JP_p42.GT	JP_p42.GQ	JP_p42.SDP	JP_p42.DP	JP_p42.FREQ	JP_p42.PVAL	JP_p42.AD	JP_p42.RD	JP_p103.GT	JP_p103.GQ	JP_p103.SDP	JP_p103.DP	JP_p103.FREQ	JP_p103.PVAL	JP_p103.AD	JP_p103.RD	JP_p48.GT	JP_p48.GQ	JP_p48.SDP	JP_p48.DP	JP_p48.FREQ	JP_p48.PVAL	JP_p48.AD	JP_p48.RD	JP_p79.GT	JP_p79.GQ	JP_p79.SDP	JP_p79.DP	JP_p79.FREQ	JP_p79.PVAL	JP_p79.AD	JP_p79.RD	locus	unstitched_chrom	unstitched_pos	unstitched_locus	MAF
Scaffold_1	15421	A	G	0.6742105926860024	-10.0	SNP	PASS	22	0	32	8	0	A/G	67.0	22	22.0	72.73%	1.7905e-07	16.0	6.0	G/G	126.0	32	32.0	84.38%	2.3785e-13	27.0	5.0	A/G	87.0	26	26.0	76.92%	1.8273e-09	20.0	6.0	G/G	113.0	28	28.0	85.71%	4.7015e-12	24.0	4.0	A/G	30.0	14	14.0	57.14%	0.00096618	8.0	6.0	A/G	90.0	32	32.0	68.75%	8.029200000000001e-122.0	10.0	A/G	42.0	13	13.0	76.92%	5.3843e-05	10.0	3.0	A/G	56.0	27	27.0	55.56%	2.0087e-06	15.0	12.0	A/G	72.0	23	23.0	73.91%	5.7694e-08	17.0	6.0	A/G	39.0	16	16.0	62.5%	0.00012413	10.0	6.0	G/G	91.0	24	24.0	83.33%	6.349299999999999e-120.0	4.0	G/G	73.0	19	19.0	84.21%	4.357e-08	16.0	3.0	A/G	81.0	30	30.0	66.67%	7.1675e-09	20.0	10.0	A/G	98.0	31	31.0	74.19%	1.3219e-10	23.0	8.0	A/G	93.0	41	41.0	58.54%	4.6506e-10	24.0	17.0	A/G	21.0	12	12.0	50%	0.006865	6.0	6.0	G/G	156.0	36	36.0	88.89%	2.0653000000000003e-16	32.0	4.0	A/G	60.0	23	23.0	65.22%	9.5813e-07	15.0	8.0	A/G	90.0	28	28.0	75%	8.7917e-10	21.0	7.0	G/G	93.0	21	21.0	90.48%	4.7003e-10	19.0	2.0	A/G	41.0	14	14.0	71.43%	7.6278e-05	10.04.0	A/G	67.0	22	22.0	72.73%	1.7905e-07	16.0	6.0	A/G	35.0	23	23.0	43.48%	0.00028066	10.0	13.0	A/G	54.0	18	18.072.22%	3.7078e-06	13.0	5.0	A/G	57.0	20	20.0	70%	1.6702e-06	14.0	6.0	A/G	57.0	26	26.0	57.69%	1.7241e-06	15.0	11.0A/G	64.0	20	20.0	75%	3.8543e-07	15.0	5.0	A/G	34.0	15	15.0	60%	0.00034983	9.0	6.0	A/G	30.0	27	27.0	33.33%	0.00088132	9.0	18.0	A/G	53.0	25	25.0	56%	4.7528e-06	14.0	11.0	A/G	85.0	27	27.0	74.07%	2.7631e-09	20.0	7.0	A/G	35.0	23	23.0	43.48%	0.00028066	10.0	13.0	A/G	35.0	14	14.0	64.29%	0.00028986	9.0	5.0	A/G	45.0	21	21.0	57.14%	2.658e-05	12.0	9.0	G/G	52.0	15	15.0	80%	5.2605e-06	12.0	3.0	A/G	21.0	12	12.0	50%	0.006865	6.0	6.0	A/G	97.0	28	28.0	78.57%	1.7583e-10	22.0	6.0	G/G	49.0	13	13.0	84.62%	1.0096e-05	11.0	2.0	A/G	38.0	26	26.0	42.31%	0.00012791	11.0	15.0	A/G	47.0	19	19.0	63.16%	1.8611e-05	12.0	7.0	Scaffold_1-15421	>super4	15421	>super4-15421	0.32578940731399764
Scaffold_1	47333	G	A	0.10570679304897317	-10.0	SNP	PASS	109	7	33	0	0	G/A	15.0	61	61.0	8.2%	0.0287	5.0	56.0	G/A	34.0	121	121.0	9.09%	0.000385	11.0	110.0	G/A	58.0	85	85.0	21.18%	1.3957e-06	18.0	67.0	G/G	268.0	144	144.0%	1.0	0.0	144.0	G/A	34.0	133	133.0	8.27%	0.00039369	11.0	122.0	G/A	50.0	118	118.0	13.56%	8.8507e-06	16.0	102.0	G/A	15.0	92	92.0	5.43%	0.029557	5.0	87.0	G/G	115.0	85	85.0	4.71%	0.060288	4.0	81.0	G/A	15.0	136	136.0	3.68%	0.030103	5.0	131.0	G/A	24.0	101	101.0	7.92%	0.0033824	8.0	93.0	G/A	27.0	144	144.0	6.25%	0.0017170999999999998	9.0	135.0	G/A	21.0	132	132.0	5.3%	0.0072006	7.0	125.0	G/A	27.0	104	104.0	8.65%	0.0016305999999999998	9.0	95.0	G/A	49.0	185	185.0	8.651.0876e-05	16.0	169.0	G/A	74.0	125	125.0	18.4%	3.9134000000000005e-08	23.0	102.0	G/A	15.0	67	67.0	7.46%	0.028927	5.0	62.0G/A	74.0	123	123.0	18.7%	3.7966e-08	23.0	100.0	G/A	15.0	154	154.0	3.25%	0.03023	5.0	149.0	G/A	74.0	115	115.0	20%	3.5135e-08	23.0	92.0	G/G	186.0	122	122.0	2.46%	0.12346	3.0	119.0	G/A	37.0	90	90.0	13.33%	0.00016497	12.0	78.0	G/A	15.0	127	127.0	3.94%	0.030022000000000007	5.0	122.0	G/A	21.0	94	94.0	7.45%	0.0069587	7.0	87.0	G/A	44.0	94	94.0	14.89%	3.6214e-05	14.0	80.0	G/G	116.0	76	76.0	2.63%	0.24834	2.0	74.0	G/A	21.0	117	117.0	5.98%	0.0071235	7.0	110.0	G/A	15.0	147	147.3.4%	0.030189	5.0	142.0	G/G	119.0	78	78.0	2.56%	0.24839	2.0	76.0	G/A	27.0	134	134.0	6.72%	0.0017000999999999993	9.0	125.G/A	27.0	142	142.0	6.34%	0.0017138	9.0	133.0	G/A	109.0	130	130.0	25.38%	1.134e-11	33.0	97.0	G/G	145.0	78	78.0	0%	1.0	0.0	78.0	G/A	56.0	60	60.0	28.33%	2.0389e-06	17.0	43.0	G/A	67.0	106	106.0	19.81%	1.5892999999999998e-07	21.0	85.0	G/A	25.0	44	44.0	18.18%	0.0027573	8.0	36.0	G/A	21.0	77	77.0	9.09%	0.006775499999999999	7.0	70.0	G/A	18.0	109	109.0	5.5%0.01456	6.0	103.0	G/A	44.0	103	103.0	13.59%	3.8029e-05	14.0	89.0	G/G	250.0	134	134.0	0%	1.0	0.0	134.0	G/A	27.0	105	105.0	8.57%	0.0016335000000000002	9.0	96.0	Scaffold_1-47333	>super4	47333	>super4-47333	0.10570679304897317
Scaffold_1	47418	T	A	0.21759331651954605	-10.0	SNP	PASS	113	2	38	0	0	T/A	45.0	70	70.0	20%	2.9687e-05	14.0	56.0	T/A	83.0	140	140.0	18.57%	4.1466000000000005e-09	26.0	114.0	T/A	82.0	97	97.0	25.77%	5.0454e-09	25.0	72.0	T/A	33.0155	155.0	7.1%	0.00040635	11.0	144.0	T/A	94.0	137	137.0	21.17%	3.5505000000000003e-10	29.0	108.0	T/A	117.0	126	126.0	27.78%	1.8658e-12	35.0	91.0	T/A	117.0	99	99.0	34.34%	1.8771e-12	34.0	65.0	T/A	34.0	109	109.0	10.09%	0.00037455	11.0	98.0	T/A	111.145	145.0	23.45%	6.4924e-12	34.0	111.0	T/A	79.0	94	94.0	25.53%	1.1069e-08	24.0	70.0	T/A	207.0	156	156.0	37.82%	1.9115e-21	59.0	97.0	T/A	190.0	138	138.0	39.13%	8.388700000000001e-20	54.0	84.0	T/A	61.0	97	97.0	19.59%	7.186e-07	19.0	78.0	T/A	116.190	190.0	18.95%	2.3297e-12	36.0	154.0	T/A	57.0	120	120.0	15%	1.9165e-06	18.0	102.0	T/A	55.0	75	75.0	22.67%	2.7475e-06	17.0	58.0	T/A	53.0	127	127.0	13.39%	4.3013e-06	17.0	110.0	T/A	178.0	157	157.0	33.12%	1.3751e-18	52.0	105.0	T/A	31.0	94	94.0	10.64%	0.00075886	10.0	84.0	T/A	169.0	121	121.0	39.67%	1.0145e-17	48.0	73.0	T/A	41.0	91	91.0	14.29%	7.701600000000001e-013.0	78.0	T/A	138.0	137	137.0	29.93%	1.3332e-14	41.0	96.0	T/T	138.0	99	99.0	4.04%	0.060601	4.0	95.0	T/A	34.0	100	100.0	11%	0.00036522	11.0	89.0	T/A	73.0	79	79.0	27.85%	4.3584e-08	22.0	57.0	T/A	83.0	141	141.0	18.44%	4.1883000000000005e-09	26.0	115.0	T/A	120.0	132	132.0	27.27%	9.1341e-13	36.0	96.0	T/A	41.0	85	85.0	15.29%	7.4354e-05	13.0	72.0	T/A	246.133	133.0	49.62%	2.5089e-25	66.0	67.0	T/A	149.0	143	143.0	30.77%	1.1254e-15	44.0	99.0	T/A	136.0	125	125.0	32%	2.1875999999999998e-14	40.0	85.0	T/A	34.0	70	70.0	15.71%	0.00031917	11.0	59.0	T/T	84.0	68	68.0	5.88%	0.059733	4.0	64.0	T/A	71.0	110	110.0	20%	7.4293e-08	22.0	88.0	T/A	22.0	44	44.0	15.91%	0.0060363	7.0	37.0	T/A	51.0	89	89.0	17.98%	7.2162e-06	16.0	73.0	T/A	71.0	112	112.0	19.64%	7.6031e-08	22.0	90.0	T/A	71.0	102	102.0	21.57%	6.7043e-08	22.0	80.0	T/A	37.0121	121.0	9.92%	0.00018333	12.0	109.0	T/A	67.0	122	122.0	17.21%	1.861e-07	21.0	101.0	Scaffold_1-47418	>super4	47418	>super4-47410.21759331651954605
